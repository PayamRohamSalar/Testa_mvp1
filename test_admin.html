<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุชุณุช ุณุณุชู ูุฏุฑุช - TESTA</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
        function TestAdmin() {
            const [testResults, setTestResults] = React.useState([]);
            const [pendingUsers, setPendingUsers] = React.useState(0);
            const [pendingOrgs, setPendingOrgs] = React.useState(0);

            const runTests = () => {
                const results = [];

                // Test 1: Check if admin user exists
                const users = localStorage.getItem('users');
                if (users) {
                    try {
                        const usersData = JSON.parse(users);
                        const admin = usersData.find(u => u.role === 'ADMIN');
                        if (admin) {
                            results.push({
                                test: 'ฺฉุงุฑุจุฑ ูุฏุฑ',
                                status: `โ ${admin.name} (${admin.email})`,
                                color: 'text-green-600'
                            });
                        } else {
                            results.push({
                                test: 'ฺฉุงุฑุจุฑ ูุฏุฑ',
                                status: 'โ ุงูุช ูุดุฏ',
                                color: 'text-red-600'
                            });
                        }
                    } catch (e) {
                        results.push({
                            test: 'ฺฉุงุฑุจุฑ ูุฏุฑ',
                            status: 'โ ุฎุทุง ุฏุฑ ุจุงุฑฺฏุฑ',
                            color: 'text-red-600'
                        });
                    }
                }

                // Test 2: Check pending users and organizations
                let pendingUserCount = 0;
                let pendingOrgCount = 0;

                if (users) {
                    try {
                        const usersData = JSON.parse(users);
                        pendingUserCount = usersData.filter(u => u.status === 'pending' && u.role !== 'ADMIN').length;
                        setPendingUsers(pendingUserCount);
                    } catch (e) {
                        console.error('Error parsing users:', e);
                    }
                }

                const orgs = localStorage.getItem('orgs');
                if (orgs) {
                    try {
                        const orgsData = JSON.parse(orgs);
                        pendingOrgCount = orgsData.filter(o => o.status === 'pending').length;
                        setPendingOrgs(pendingOrgCount);
                    } catch (e) {
                        console.error('Error parsing orgs:', e);
                    }
                }

                results.push({
                    test: 'ฺฉุงุฑุจุฑุงู ุฏุฑ ุงูุชุธุงุฑ ุชุฃุฏ',
                    status: `๐ ${pendingUserCount} ฺฉุงุฑุจุฑ`,
                    color: pendingUserCount > 0 ? 'text-yellow-600' : 'text-gray-600'
                });

                results.push({
                    test: 'ุณุงุฒูุงูโูุง ุฏุฑ ุงูุชุธุงุฑ ุชุฃุฏ',
                    status: `๐ ${pendingOrgCount} ุณุงุฒูุงู`,
                    color: pendingOrgCount > 0 ? 'text-yellow-600' : 'text-gray-600'
                });

                // Test 3: Check notifications
                const notifications = localStorage.getItem('notifications');
                if (notifications) {
                    try {
                        const notificationsData = JSON.parse(notifications);
                        const orgRequests = notificationsData.filter(n => n.type === 'org_request');
                        results.push({
                            test: 'ุงุนูุงูโูุง ุฏุฑุฎูุงุณุช ุณุงุฒูุงู',
                            status: `๐ฌ ${orgRequests.length} ุงุนูุงู`,
                            color: 'text-blue-600'
                        });
                    } catch (e) {
                        results.push({
                            test: 'ุงุนูุงูโูุง ุฏุฑุฎูุงุณุช ุณุงุฒูุงู',
                            status: 'โ ุฎุทุง',
                            color: 'text-red-600'
                        });
                    }
                }

                setTestResults(results);
            };

            const createTestUser = () => {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const newUser = {
                    id: `u-test-${Date.now()}`,
                    role: 'SOLVER',
                    email: `test${Date.now()}@example.com`,
                    name: 'ฺฉุงุฑุจุฑ ุขุฒูุงุด',
                    password: '123456',
                    avatar: null,
                    bio: 'ฺฉุงุฑุจุฑ ุขุฒูุงุด ุจุฑุง ุชุณุช ุณุณุชู ูุฏุฑุช',
                    skills: ['ุชุณุช', 'ุจุฑูุงููโููุณ'],
                    reputation: 0,
                    status: 'pending',
                    createdAt: new Date().toISOString()
                };

                users.push(newUser);
                localStorage.setItem('users', JSON.stringify(users));
                runTests();
                alert('ฺฉุงุฑุจุฑ ุขุฒูุงุด ุงุฌุงุฏ ุดุฏ!');
            };

            const createTestOrg = () => {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const orgs = JSON.parse(localStorage.getItem('orgs') || '[]');
                const notifications = JSON.parse(localStorage.getItem('notifications') || '[]');

                const newOrg = {
                    id: `o-test-${Date.now()}`,
                    name: 'ุณุงุฒูุงู ุขุฒูุงุด',
                    domains: ['ุชุณุช', 'ุจุฑูุงููโููุณ'],
                    description: 'ุณุงุฒูุงู ุขุฒูุงุด ุจุฑุง ุชุณุช ุณุณุชู ูุฏุฑุช',
                    logo: null,
                    website: 'https://test.com',
                    contactInfo: {
                        phone: '021-12345678',
                        address: 'ุขุฏุฑุณ ุขุฒูุงุด'
                    },
                    status: 'pending',
                    createdAt: new Date().toISOString()
                };

                const newUser = {
                    id: `u-test-org-${Date.now()}`,
                    role: 'SEEKER',
                    email: `org-test${Date.now()}@example.com`,
                    name: 'ููุงูุฏู ุณุงุฒูุงู ุขุฒูุงุด',
                    password: '123456',
                    orgId: newOrg.id,
                    avatar: null,
                    bio: `ููุงูุฏู ${newOrg.name}`,
                    skills: ['ูุฏุฑุช', 'ุชุนุฑู ฺุงูุด'],
                    reputation: 0,
                    status: 'pending',
                    createdAt: new Date().toISOString()
                };

                orgs.push(newOrg);
                users.push(newUser);
                notifications.push({
                    id: `notif-test-${Date.now()}`,
                    type: 'org_request',
                    text: `ุฏุฑุฎูุงุณุช ุชุฃุฏ ุณุงุฒูุงู ุฌุฏุฏ: ${newOrg.name} (${newUser.name})`,
                    createdAt: new Date().toISOString(),
                    read: false,
                    userId: 'u-admin',
                    targetId: newOrg.id
                });

                localStorage.setItem('users', JSON.stringify(users));
                localStorage.setItem('orgs', JSON.stringify(orgs));
                localStorage.setItem('notifications', JSON.stringify(notifications));

                runTests();
                alert('ุณุงุฒูุงู ุขุฒูุงุด ุงุฌุงุฏ ุดุฏ!');
            };

            React.useEffect(() => {
                runTests();
            }, []);

            return (
                <div className="max-w-4xl mx-auto p-6">
                    <header className="mb-6">
                        <h1 className="text-2xl font-bold">ุชุณุช ุณุณุชู ูุฏุฑุช</h1>
                        <p className="text-gray-600 mt-2">ุจุฑุฑุณ ุนููฺฉุฑุฏ ุชุฃุฏ ฺฉุงุฑุจุฑุงู ู ุณุงุฒูุงูโูุง</p>
                    </header>

                    <main className="bg-white rounded-2xl shadow p-6 space-y-6">
                        <div className="grid md:grid-cols-2 gap-6">
                            <div>
                                <h2 className="font-semibold mb-4">ูุถุนุช ุณุณุชู</h2>
                                <div className="space-y-2">
                                    {testResults.map((result, index) => (
                                        <div key={index} className="flex justify-between items-center p-3 bg-gray-50 rounded">
                                            <span className="font-medium">{result.test}</span>
                                            <span className={result.color}>{result.status}</span>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <div>
                                <h2 className="font-semibold mb-4">ุงุฌุงุฏ ุฏุงุฏูโูุง ุขุฒูุงุด</h2>
                                <div className="space-y-3">
                                    <button
                                        onClick={createTestUser}
                                        className="w-full px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                                    >
                                        โ ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุขุฒูุงุด
                                    </button>
                                    <button
                                        onClick={createTestOrg}
                                        className="w-full px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600"
                                    >
                                        ๐ข ุงุฌุงุฏ ุณุงุฒูุงู ุขุฒูุงุด
                                    </button>
                                    <button
                                        onClick={runTests}
                                        className="w-full px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600"
                                    >
                                        ๐ ุจุฑูุฒุฑุณุงู ูุถุนุช
                                    </button>
                                </div>

                                {(pendingUsers > 0 || pendingOrgs > 0) && (
                                    <div className="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded">
                                        <div className="text-sm text-yellow-800">
                                            <strong>โ๏ธ ุฏุงุฏูโูุง ุฏุฑ ุงูุชุธุงุฑ ุชุฃุฏ:</strong>
                                            <br />
                                            โข {pendingUsers} ฺฉุงุฑุจุฑ
                                            <br />
                                            โข {pendingOrgs} ุณุงุฒูุงู
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        <div className="border-t pt-6">
                            <h2 className="font-semibold mb-4">ุฑุงูููุง ุชุณุช</h2>
                            <div className="space-y-4">
                                <div className="p-4 bg-blue-50 rounded">
                                    <h3 className="font-medium text-blue-800 mb-2">๐ ุชุณุช ฺฉุงูู ุชุฃุฏ:</h3>
                                    <ol className="list-decimal pr-5 text-blue-700 text-sm space-y-1">
                                        <li>ุฑู "ุงุฌุงุฏ ุณุงุฒูุงู ุขุฒูุงุด" ฺฉูฺฉ ฺฉูุฏ</li>
                                        <li>ุจุง ุญุณุงุจ ูุฏุฑ ูุงุฑุฏ ุดูุฏ: admin@platform.ir / 123456</li>
                                        <li>ุจู ูพูู ูุฏุฑุช ุจุฑูุฏ (#admin)</li>
                                        <li>ุณุงุฒูุงู ุฏุฑ ุงูุชุธุงุฑ ุชุฃุฏ ุฑุง ูุดุงูุฏู ฺฉูุฏ</li>
                                        <li>ุฑู "ุชุฃุฏ" ฺฉูฺฉ ฺฉูุฏ</li>
                                        <li>ูุถุนุช ุณุงุฒูุงู ุจู "ุชุฃุฏ ุดุฏู" ุชุบุฑ ฺฉูุฏ</li>
                                    </ol>
                                </div>

                                <div className="p-4 bg-green-50 rounded">
                                    <h3 className="font-medium text-green-800 mb-2">๐ค ุชุณุช ูพุฑููุงู:</h3>
                                    <ol className="list-decimal pr-5 text-green-700 text-sm space-y-1">
                                        <li>ุจุง ุญุณุงุจ ูุฏุฑ ูุงุฑุฏ ุดูุฏ</li>
                                        <li>ุจู ูพูู ูุฏุฑุช ุจุฑูุฏ</li>
                                        <li>ุฑู "ูุดุงูุฏู" ฺฉูฺฉ ฺฉูุฏ</li>
                                        <li>ูพุฑููุงู ฺฉุงูู ฺฉุงุฑุจุฑ ููุงุด ุฏุงุฏู ุดูุฏ</li>
                                        <li>ุชูุงู ุงุทูุงุนุงุช ูพุงูุ ููุงุฑุชโูุง ู ูุถุนุช ููุงุด ุฏุงุฏู ุดูุฏ</li>
                                    </ol>
                                </div>

                                <div className="p-4 bg-purple-50 rounded">
                                    <h3 className="font-medium text-purple-800 mb-2">๐ ุขูุงุฑ ุณุณุชู:</h3>
                                    <ul className="list-disc pr-5 text-purple-700 text-sm space-y-1">
                                        <li>ุขูุงุฑ ฺฉุงุฑุจุฑุงู ฺฉูุ ุณุงุฒูุงูโูุง ฺฉู ู ุฏุฑ ุงูุชุธุงุฑ ุชุฃุฏ ููุงุด ุฏุงุฏู ุดูุฏ</li>
                                        <li>ูพุณ ุงุฒ ุชุฃุฏุ ุขูุงุฑ ุจุฑูุฒุฑุณุงู ุดูุฏ</li>
                                        <li>ุงุนูุงูโูุง ุฌุฏุฏ ุจุฑุง ุฏุฑุฎูุงุณุชโูุง ุณุงุฒูุงู ุงุฌุงุฏ ุดูุฏ</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                            <h3 className="font-medium text-yellow-800 mb-2">โ๏ธ ูฺฉุงุช ููู:</h3>
                            <ul className="list-disc pr-5 text-yellow-700 text-sm space-y-1">
                                <li>ฺฉุงุฑุจุฑุงู ุฌุฏุฏ ุจุง ูุถุนุช "pending" ุงุฌุงุฏ ูโุดููุฏ</li>
                                <li>ุณุงุฒูุงูโูุง ุฌุฏุฏ ูุงุฒ ุจู ุชุฃุฏ ูุฏุฑ ุฏุงุฑูุฏ</li>
                                <li>ูพุณ ุงุฒ ุชุฃุฏุ ฺฉุงุฑุจุฑุงู ูโุชูุงููุฏ ูุงุฑุฏ ุณุณุชู ุดููุฏ</li>
                                <li>ุฏุฑุฎูุงุณุชโูุง ุณุงุฒูุงู ุงุนูุงู ุจุฑุง ูุฏุฑ ุงุฌุงุฏ ูโฺฉููุฏ</li>
                                <li>ูพุฑููุงูโูุง ฺฉุงูู ุจุฑุง ูุฑ ุฏู ููุน ฺฉุงุฑุจุฑ ููุงุด ุฏุงุฏู ูโุดูุฏ</li>
                            </ul>
                        </div>
                    </main>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById("root")).render(<TestAdmin />);
    </script>
</body>
</html>
